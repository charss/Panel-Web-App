{% extends "admin.html" %}
{% block title %}Home Page{% endblock %}
{% block pagename %}
Rubrics
{% endblock %}
{% block button %}
<a href="/new_rubric/">
    <button>Create New Rubric</button>
</a>
{% endblock %}
{% block content %}
    <style>
        #text {
            width: 500px;
        }

        textarea {
            height: 30px;
            width: 100%;
            transition: all 0.5s ease;
        }

        textarea:focus {
            height: 5em;
        }

        #desc, #category {
            width: 100%;
        }
    </style>

    <body onload='check()' id='bodybody'>
        <div id="overlay">
            <div class='container'>
                <div class='header_div'>
                    <div class='header_title'>
                        <p>Edit Rubric</p>
                    </div>
                    <div class='close_button'>
                        <a href='/rubrics/'>
                            <img src="{{ url_for('static', filename='close.png') }}">
                        </a>
                    </div>
                </div>

                <div class='content_div'>
                    <form method='POST'>
                        <div class='form_div'>
                            <div class='query'>
                                <label for="rubricCode">Rubric Code:</label>
                                <span>
                                    <input type='text' id='rubricCode' name='rubricCode' value ="{{ to_edit.id }}" disabled><br>
                                </span>
                            </div>

                            <input type='hidden' value='{{ to_edit.rubric_type }}' id='hidden_type'>

                            <div class='query'>
                                <label for="rubType">Rubric Type:</label>
                                <span>
                                    <input type='text' id='rubricType' name='rubricType' value ="{{ to_edit.rubric_type }}" disabled><br>
                                </span>
                            </div>

                            <label for="pblLvl">PBL Level:</label>
                            <span>
                                {% for x in range(1, 5) %}
                                    {% set temp = to_edit.pbl_lvl[3] | int %}
                                    <input type="radio" id="pbl{{ x }}" name="pblLvl" value="PBL{{ x }}" {% if temp == x %}checked {% endif %}>
                                    <label for="pbl{{ x }}">PBL{{ x }}</label>
                                {% endfor %}
                            </span>
                            

                            <div class='query'>
                                <label for="category">Category:</label>
                                <span>
                                    <input type='text' id='category' name='category' style='text-align: left;' required value='{{ to_edit.category }}'>
                                </span>
                            </div>

                            <div class='query'>
                                <label for="desc">Description:</label>
                                <span>
                                    <input type='text' id='desc' name='desc' style='text-align: left;' value='{{ to_edit.desc }}' required>
                                </span>
                            </div>

                            <div class='query'>
                                <label for='rate5'>Rate 5:</label>
                                <span>
                                    <textarea id='rate5' name='rate5' required>{{ to_edit.rate5 }}</textarea>
                                </span>
                            </div>

                            <div class='query'>
                                <label for='rate4'>Rate 4:</label>
                                <span>
                                    <textarea id='rate4' name='rate4' required>{{ to_edit.rate4 }}</textarea>
                                </span>
                            </div>

                            <div class='query'>
                                <label for='rate3'>Rate 3:</label>
                                <span>
                                    <textarea id='rate3' name='rate3' required>{{ to_edit.rate3 }}</textarea>
                                </span>
                            </div>

                            <div class='query'>
                                <label for='rate2'>Rate 2:</label>
                                <span>
                                    <textarea id='rate2' name='rate2' required>{{ to_edit.rate2 }}</textarea>
                                </span>
                            </div>

                            <div class='query'>
                                <label for='rate1'>Rate 1:</label>
                                <span>
                                    <textarea id='rate1' name='rate1' required>{{ to_edit.rate1 }}</textarea>
                                </span>
                            </div>

                            <div class='query'>
                                <label for="weight">Weight</label>
                                <span>
                                    <input type="number" id="weight" name='weight' autocomplete='off' min='1' max='9' value='{{ to_edit.weight }}' onkeydown='return false;'>
                                </span>
                            </div>
                            <button type='submit' id='submit' name='submit'>Submit</button>
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>

        <div class='display_grid'>
            {% if rubrics %}
                {% for rubric in rubrics %}
                    <div class='box'>
                        <p>ID: {{ rubric.id }}</p>
                        <p>Description: {{ rubric.desc }}</p>
                        <p>Rate 5: {{ rubric.rate5 }}</p>
                        <p>Rate 4: {{ rubric.rate4 }}</p>
                        <p>Rate 3: {{ rubric.rate3 }}</p>
                        <p>Rate 2: {{ rubric.rate2 }}</p>
                        <p>Rate 1: {{ rubric.rate1 }}</p>
                        <p>Weight: x{{ rubric.weight }}</p>
                        <p>Rubric Type: {{ rubric.rubric_type }}</p>
                        <p>PBL Level: {{ rubric.pbl_lvl }}</p>
                        <p>Category: {{ rubric.category }}</p>
                        <br>
                        <a href="/edit_rubric/{{ rubric.id }}">
                            <button>Edit</button>
                        </a>
                        <a href="/delete_rubric/ {{ rubric.id }}">
                            <button>Delete</button>
                        </a>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <script>

            var rubric_type = document.getElementById('hidden_type').value
            if (rubric_type == 'Individual') {
                console.log('CHECK MO INDIVIDUAL')
                document.getElementById('individual').checked = true;
                document.getElementById('category').disabled = true;
                document.getElementById('pbl1').disabled = true;
                document.getElementById('pbl2').disabled = true;
                document.getElementById('pbl3').disabled = true;
                document.getElementById('pbl4').disabled = true;
            } else {
                document.getElementById('group').checked = true;
            }

            function check() {
                const rbs = document.querySelectorAll('input[name="rubType"]');
                let selectedValue;
                for (const rb of rbs) {
                    if (rb.checked) {
                        selectedValue = rb.value;
                        break;
                    }
                }
                if (selectedValue == 'Individual') {
                    document.getElementById('category').disabled = true;
                    document.getElementById('pbl1').disabled = true;
                    document.getElementById('pbl2').disabled = true;
                    document.getElementById('pbl3').disabled = true;
                    document.getElementById('pbl4').disabled = true;
                } else {
                    document.getElementById('category').disabled = false;
                    document.getElementById('pbl1').disabled = false;
                    document.getElementById('pbl2').disabled = false;
                    document.getElementById('pbl3').disabled = false;
                    document.getElementById('pbl4').disabled = false;
                }
            }
        </script>
    </body>
    
{% endblock %}